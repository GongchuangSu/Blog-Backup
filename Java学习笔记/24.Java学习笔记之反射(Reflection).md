 title: Java学习笔记之反射(Reflection) 
layout: post
date: 7/20/2016 3:51:59 PM  
comments: true
type: "categories"
categories: 
- Java
tags: 
- java
- 反射

---

![](http://i.imgur.com/UdqywSj.png)

# 什么是反射
能够分析类能力的程序称为反射(reflection)

# 反射可以用来干什么
Java反射机制可以让我们在编译期(Compile Time)之外的运行期(Runtime)检查类，接口，变量以及方法的信息。
- 在运行中分析类的能力
- 在运行中查看对象
- 实现通用的数组操作代码
- 利用Method对象

# Class类
在程序运行期间，Java运行时系统始终为所有的对象维护一个被称为运行时的类型标识。这个信息跟踪着这个对象所属的类。可以通过专门的Java类访问这些信息，保存这些信息的类被称为**Class类**。
获取Class对象的三种方法：
1. 通过调用Object类中的getClass()方法返回一个Class对象
```java
Object myObject = new Object();
Class myObjectClass = myObject.getClass();
```
2. 通过调用静态方法forName获得类名对应的Class对象
```java
String className = "java.util.Date";
Class cl = Class.forName(className);
```
注意：在使用`Class.forName()`方法时，必须提供一个类的全名，这个全名包括类所在的包的名字。
3. 如果在调用该方法时，没有找到该路径的类，将会抛出ClassNotFoundException。
获得Class对象的第三种方法非常简单，如果`T`是任意的Java类型，`T.class`将代表匹配的类对象
```java
Class cl1 = Date.class;
Class cl2 = int.class;
```
补充：可通过下面方式访问类的父类
```java
Object myObject = new Object();
Class myObjectClass = myObject.getSuperclass();
```

# 获取类名
通过Class对象可以获取两个版本的类名：
1. 通过getName()方法返回类的全限定类名(包含包名)：
```java
Class aClass = ... //获取Class对象
String className = aClass.getName();
```
2. 通过getSimpleName()方法返回类名(不包含包名)
```java
Class aClass = ... //获取Class对象
String className = aClass.getSimpleName();
```

# 获取修饰符
可以通过Class对象的`getModifiers()`方法来访问一个类的修饰符，该方法通过返回一个整型数值，用不同的位开关描述public/private/static等修饰符的使用状况。
```java
Class aClass = ... //获取Class对象
int modifiers = aClass.getModifiers();
```
还可以使用Modifier类中的isPublic、isPrivate或isFinal判断方法或构造器是否是public、private或final。
```java
Modifier.isAbstract(int modifiers);
Modifier.isFinal(int modifiers);
Modifier.isInterface(int modifiers);
Modifier.isNative(int modifiers);
Modifier.isPrivate(int modifiers);
Modifier.isProtected(int modifiers);
Modifier.isPublic(int modifiers);
Modifier.isStatic(int modifiers);
Modifier.isStrict(int modifiers);
Modifier.isSynchronized(int modifiers);
Modifier.isTransient(int modifiers);
Modifier.isVolatile(int modifiers);
```
# 获取包信息
可通过以下方式获取包信息：
```java
...
Object object = new Object();
Class cl = object.getClass();
System.out.println(cl.getPackage());
...
/*output
package java.lang, Java Platform API Specification, version 1.7
*/
```
# 获取实现的接口集合
可通过调用Class对象的`getInterfaces()`方法获取一个类实现的接口集合
```java
Class aClass = ... //获取Class对象
Class[] interfaces = aClass.getInterfaces();
```
注意：getInterfaces()方法仅仅只返回当前类所实现的接口，不包括当前类的父类所实现的接口。

# 获取构造器
可通过调用Class对象的`getConstructors()`方法获取一个类的构造函数
```java
Class aClass = ... //获取Class对象
Constructor[] constructors = aClass.getConstructors();
```


# 获取方法
可通过调用Class对象的`getMethods()`方法获取一个类的所有方法
```java
Class aClass = ... //获取Class对象
Method[] method = aClass.getMethods();
```

# 获取变量
可通过调用Class对象的`getFields()`方法获取一个类的成员变量
```java
Class aClass = ... //获取Class对象
Field[] method = aClass.getFields();
```

# 获取注解
可通过调用Class对象的`getAnnotations()`方法获取一个类的注解
```java
Class aClass = ... //获取Class对象
Annotation[] annotations = aClass.getAnnotations();
```

# 参考资料
1. Java核心技术（卷Ⅰ）

